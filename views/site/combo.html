<html>
    <body>
        
        <script>

            let start = Date.now();
            



            // var a = [1,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];
            // var b = [5,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];

            // var a = [1,2,3,4,5.1,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];
            // var b = [5.1,10,12,4,10,6,66,100,500,3000];

            // var a = [380.61,380.61,425.8,109.46,298.18,150.64,10.04,5.02,502.12,15.06,50.21,502.12,381.61,40.17,15.06,251.06,200.85,150.64,828.51,502.12,100.42,10.04,80.34,803.4,20.08];
            // var b = [298.18,913.86,1296.48,3705.65];

            var a = [331.4, 200.85, 50.21, 208.73, 50.21, 165.7, 371.57, 20.08, 20.08, 150.64, 110.47, 20.08, 20.08, 149.09];
            var b = [627.64, 582.46, 301.27, 208.73, 149.09];





            var result = [];
            var currentCombo = []
            var aBkp = [...a]
            var bBkp = [...b]
            var skipCheckTime = 0
            var iterationId = 0

            solve()

            // if results are incomplete try with descending order
            if(result.length != b.length){
              result = [];
              currentCombo = []
              a = [...aBkp]
              b = [...bBkp]
              solve(0)
            }

            let timeTaken = Date.now() - start;
            console.log("Total time taken : " + timeTaken + " milliseconds");
            
            console.log(result)
            // console.log(skipCheckTime)
            // console.log("iterations : " + iterationId)

            
            function solve(ascendingOrder = 1){
              a = a.sort(function(a, b){return a - b}); // sort ascending

              if(ascendingOrder)
                b = b.sort(function(a, b){return a - b}); // sort ascending
              else
                b = b.sort(function(a, b){return b - a}); // sort descending

              a = a.map(x => to2DP(x * 100)); // convert to integer
              b = b.map(x => to2DP(x * 100)); // convert to integer

              for (let bi = 0; bi < b.length; bi++) { // try to find matches for numbers in b                
                  // try length 1, 2 etc...
                  var maxLength = a.length - b.length + 2 + bi

                  if(bi == b.length - 1){ // if last element of b
                      // check if left-over elements are the solution
                      currentCombo = initialCombo(a.length)
                  }

                  // skip if solution is already found
                  if(bi != b.length - 1 || b[bi] != getCurrentSum()){

                    for (let length = 1; length <= maxLength; length++) {
                        tryLength(length, b[bi])
                
                        // break if a match
                        if(b[bi] == getCurrentSum()) 
                            break
                    }
                  }
              
                  if(b[bi] == getCurrentSum()) { // if a match
                      result[bi] = getCombination() // note it down
              
                      removeComboFromA()
                  }
              
              }
            }

            
            function removeComboFromA(){
                currentCombo = currentCombo.sort(function(a, b){return b - a}); // sort descending
            
                for (let i = 0; i < currentCombo.length; i++) {
                    a.splice(currentCombo[i], 1);
                }
            }
            
            function tryLength(length, needle){
                currentCombo = initialCombo(length)  // values in this array are pointers into array a
            
                do {
                    // return if match is found
                    if(needle == getCurrentSum())
                        return
            
                    // try next combination
                    currentCombo = nextCombo(currentCombo, currentCombo.length - 1, needle, 1);
                } while (currentCombo != false);
            }

            function nextCombo(currentCombo, incrementPos, needle, level){
              let r
              let start

              if(currentCombo[incrementPos] < a.length - 1){
                  currentCombo[incrementPos]++

                  if(needToSkipCombination(currentCombo, incrementPos, needle))
                     r = incrementFromStableParent(incrementPos) // skip
                  else
                    r = currentCombo

                  return r
              }

              return incrementFromStableParent(incrementPos)
            }
            
            function needToSkipCombination(currentCombo, incrementPos, needle){
                let sum = a[currentCombo[incrementPos]]

                for (let i = 0; i < incrementPos; i++) {
                  sum += a[currentCombo[i]]
                }

                // skip if sum is already greater than needle
                return sum > needle;
            }

            function incrementFromStableParent(incrementPos){
              for (let i = incrementPos; i > 0; i--) {
                if(currentCombo[i] - currentCombo[i-1] > 2){
                  return incrementRightSide(i)
                }
              }

              return false
            }

            function incrementRightSide(i){
              if(currentCombo[i-1] + currentCombo.length - i + 1 >= a.length){
                if(i >= 2){
                  incrementRightSide(i - 1)
                }else{
                  return false
                }
              }

              currentCombo[i-1]++
              for (let j = i; j < currentCombo.length; j++) {
                currentCombo[j] = currentCombo[j-1] + 1
              }

              return currentCombo
            }
            
            
            function initialCombo(length){
                let arr = []
                for (let i = 0; i < length; i++) {
                    arr[i] = i
                }
                
                return arr;
            }
            
            function getCurrentSum(){
                if(typeof currentCombo == 'undefined' || !currentCombo)
                    return 0;
            
                return currentCombo.reduce(getSum, 0) 
            }

            function getSum(total, num) {
                return total + a[num]
            }

            // to 2 decimal places
            function to2DP(x) {
              return Math.round(x*100) / 100
            }
            
            function getCombination(){
                var arr = []
                for (let i = 0; i < currentCombo.length; i++) {
                    arr.push(to2DP(a[currentCombo[i]]/100))  // convert to 2 decimal places
                }
                
                return arr;
            }
            
            </script>
            

    </body>
</html>