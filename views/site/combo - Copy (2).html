<html>
    <body>
        
        <script>

            let start = Date.now();
            



            var a = [1,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];
            var b = [5,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,10,12,4,10,6,66,100,500,3000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000,2,3,4,5,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];

            // var a = [1,2,3,4,5.1,6,3,1,2,3,11,22,33,8,9,10,20,30,40,200,300,1000,2000];
            // var b = [5.1,10,12,4,10,6,66,100,500,3000];

            // var a = [380.61,380.61,425.8,109.46,298.18,150.64,10.04,5.02,502.12,15.06,50.21,502.12,381.61,40.17,15.06,251.06,200.85,150.64,828.51,502.12,100.42,10.04,80.34,803.4,20.08];
            // var b = [298.18,913.86,1296.48,3705.65];







            var result = [];
            var currentCombo = []
            var aInverse = []
            // var sumCacheIndex = -1
            // var sumCacheValue = -1
            
            a = a.sort(function(a, b){return a - b}); // sort ascending
            b = b.sort(function(a, b){return a - b}); // sort ascending

            a = a.map(x => to2DP(x * 100)); // convert to integer
            b = b.map(x => to2DP(x * 100)); // convert to integer
            // var aInverse = a.map(({ k, v }) => ({ [v]: k }));

            // a.forEach(function(k, v) {
            //   if(aInverse[k] == undefined)
            //     aInverse[k] = []
            //   aInverse[k] = [...aInverse[k], v]
            // })

            for (let bi = 0; bi < b.length; bi++) { // try to find matches for numbers in b                
                // try length 1, 2 etc...
                var maxLength = a.length - b.length + 2 + bi
                // maxLength = 30

                if(bi == b.length - 1){ // if last element of b
                      // check if left-over elements are the solution
                      currentCombo = initialCombo(a.length)
                }

                // skip if solution is already found
                if(bi != b.length - 1 || b[bi] != getCurrentSum()){

                  for (let length = 1; length <= maxLength; length++) {
                      tryLength(length, b[bi])
              
                      // break if a match
                      if(b[bi] == getCurrentSum()) 
                          break

                  }
                }
            
                if(b[bi] == getCurrentSum()) { // if a match
                    result[bi] = getCombination() // note it down
            
                    removeComboFromA()
                }
            
            }

            let timeTaken = Date.now() - start;
            console.log("Total time taken : " + timeTaken + " milliseconds");
            
            console.log(result)
            
            function removeComboFromA(){
                currentCombo = currentCombo.sort(function(a, b){return b - a}); // sort descending
            
                for (let i = 0; i < currentCombo.length; i++) {
                    a.splice(currentCombo[i], 1);
                }

                // aInverse = []
                // a.forEach(function(k, v) {
                //   if(aInverse[k] == undefined)
                //     aInverse[k] = []
                //   aInverse[k] = [...aInverse[k], v]
                // })
            }
            
            function tryLength(length, needle){
                sumCacheIndex = -1
                sumCacheValue = -1
                currentCombo = initialCombo(length)  // values in this array are pointers into array a
            
                do {
                    // return if match is found
                    if(needle == getCurrentSum())
                        return
            
                    // try next combination
                    currentCombo = nextCombo(currentCombo, currentCombo.length - 1, needle, 1);
                } while (currentCombo != false);
            }

            function nextCombo(currentCombo, incrementPos, needle, level){
              var r
                do {
                    if(currentCombo[incrementPos] < a.length - 1){
                        if(incrementPos == currentCombo.length - 1){ // if last element of combo
                            // value we need to find
                            let targetValue = needle - (getCurrentSum() - a[currentCombo[incrementPos]])

                            // r = a.findIndex((element) => element == targetValue)
                            // let oldvalue = currentCombo[incrementPos]
                            // r = aInverse[targetValue]
                
                            do {
                                currentCombo[incrementPos]++
                
                                if(a[currentCombo[incrementPos]] == targetValue)
                                    break; // found a possible value
                            } while (currentCombo[incrementPos] < a.length - 1);

                            // currentCombo[incrementPos] = a.length - 1
                            // if(r != undefined){
                            //   r = r.find(element => element > oldvalue)
                            //   currentCombo[incrementPos] = r

                            //   if(r == undefined)
                            //     currentCombo[incrementPos] = a.length - 1
                            // }

                            // if(r == undefined || r <= currentCombo[incrementPos - 1] || r == oldvalue){
                            //   currentCombo[incrementPos] = a.length - 1
                            // }
                        }else{
                            currentCombo[incrementPos]++
                          
                            if(needToSkipCombination(currentCombo, incrementPos, needle))
                                continue; // skip
                        }
                
                        return currentCombo
                    } else {
                        if(incrementPos == 0)
                            return false
                
                        do {
                          r = nextCombo(currentCombo, incrementPos - 1, needle, level + 1)
                          
                          if(r == false)
                              return false
                        } while (currentCombo[incrementPos - 1] + 1 == a.length);
                        
                        currentCombo[incrementPos] = currentCombo[incrementPos - 1] + 1
                
                        if(needToSkipCombination(currentCombo, incrementPos, needle))
                            continue; // skip
                
                        return currentCombo
                    }
                } while (true);
            
            }
            
            function needToSkipCombination(currentCombo, incrementPos, needle){
                let sum = 0

                // if(sumCacheIndex == currentCombo[incrementPos - 1])
                //   sum = sumCacheValue
                // else{
                  for (let i = 0; i < incrementPos; i++) {
                    sum += a[currentCombo[i]]
            
                    // skip if sum is already greater than needle
                    if(sum > needle)
                        return true;
            
                    // skip if number is already used
                    if(currentCombo[incrementPos] == currentCombo[i])
                        return true;
                  }
                // }

                // sumCacheIndex = currentCombo[incrementPos - 1]
                // sumCacheValue = sum
                
                sum += a[currentCombo[incrementPos]]
                
                return false;
            }
            
            
            function initialCombo(length){
                let arr = []
                for (let i = 0; i < length; i++) {
                    arr[i] = i
                }
                
                return arr;
            }
            
            function getCurrentSum(){
                if(typeof currentCombo == 'undefined' || !currentCombo)
                    return 0;
            
                return currentCombo.reduce(getSum, 0)
            }

            function getSum(total, num) {
                return total + a[num]
            }

            // to 2 decimal places
            function to2DP(x) {
              return Math.round(x*100) / 100
            }
            
            function getCombination(){
                var arr = []
                for (let i = 0; i < currentCombo.length; i++) {
                    arr.push(to2DP(a[currentCombo[i]]/100))  // convert to 2 decimal places
                }
                
                return arr;
            }
            
            </script>
            

    </body>
</html>